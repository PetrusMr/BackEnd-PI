<!DOCTYPE html>
<html>
<head>
    <title>Teste API EasyControl</title>
</head>
<body>
    <h1>Teste das APIs</h1>
    
    <div>
        <h2>1. Teste Variáveis de Ambiente</h2>
        <button onclick="testEnv()">Testar ENV</button>
        <div id="envResult"></div>
    </div>
    
    <div>
        <h2>2. Teste API Gemini</h2>
        <button onclick="testGemini()">Testar Gemini</button>
        <div id="geminiResult"></div>
    </div>
    
    <div>
        <h2>3. Teste Análise de Imagem</h2>
        <input type="file" id="imageInput" accept="image/*">
        <button onclick="testImage()">Analisar Imagem</button>
        <div id="imageResult"></div>
    </div>

    <script>
        const API_URL = 'https://seu-projeto.vercel.app'; // SUBSTITUA pela sua URL

        async function testEnv() {
            try {
                const response = await fetch(`${API_URL}/api/test-env`);
                const data = await response.json();
                document.getElementById('envResult').innerHTML = 
                    `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                document.getElementById('envResult').innerHTML = 
                    `<p style="color:red">Erro: ${error.message}</p>`;
            }
        }

        async function testGemini() {
            try {
                const response = await fetch(`${API_URL}/api/gemini/test-api`);
                const data = await response.json();
                document.getElementById('geminiResult').innerHTML = 
                    `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                document.getElementById('geminiResult').innerHTML = 
                    `<p style="color:red">Erro: ${error.message}</p>`;
            }
        }

        async function testImage() {
            const fileInput = document.getElementById('imageInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Selecione uma imagem primeiro');
                return;
            }

            const reader = new FileReader();
            reader.onload = async function(e) {
                try {
                    const base64 = e.target.result.split(',')[1];
                    
                    const response = await fetch(`${API_URL}/api/gemini/analisar-componentes`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ imageBase64: base64 })
                    });
                    
                    const data = await response.json();
                    document.getElementById('imageResult').innerHTML = 
                        `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                } catch (error) {
                    document.getElementById('imageResult').innerHTML = 
                        `<p style="color:red">Erro: ${error.message}</p>`;
                }
            };
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>